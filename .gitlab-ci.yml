image: zephyrprojectrtos/zephyr-build:v0.26.13

.common:
  variables:
    GIT_SUBMODULE_STRATEGY: recursive
  before_script:
    - rm -rf ../.west
    - west init -l .
    - west update
    - west zephyr-export
    - pip3 install -r ../zephyr/scripts/requirements-base.txt
  script:
    - source ../zephyr/zephyr-env.sh
    - west build -p always -b $BOARD samples/subsys/greybus/net/
  artifacts:
    paths:
      - build/zephyr/zephyr.bin

build_beagleconnect_freedom:
  extends: .common
  variables:
    BOARD: beagleconnect_freedom
  stage: build

build_beagleplay_cc1352p7:
  extends: .common
  variables:
    BOARD: beagleplay/cc1352p7
  stage: build